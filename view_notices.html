<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>All Notices â€“ School ERP</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {
    margin:0;
    font-family:Poppins, sans-serif;
    background:#f4f6f9;
    color:#333;
    overflow-x:hidden;
}

/* ---------- SIDEBAR ---------- */
.sidebar {
    width:240px;
    background:#233465;
    color:white;
    height:100vh;
    position:fixed;
    top:0;
    left:-240px;
    padding-top:20px;
    transition: left 0.3s ease;
    z-index:1000;
}

.sidebar.active {
    left:0;
}

.sidebar h2 {
    text-align:center;
    margin-bottom:20px;
}

.sidebar a {
    display:block;
    padding:14px 20px;
    color:white;
    text-decoration:none;
    border-radius:6px;
}

.sidebar a:hover,
.sidebar a.active {
    background:rgba(255,255,255,0.25);
}

/* ---------- OVERLAY ---------- */
.overlay {
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background:rgba(0,0,0,0.4);
    display:none;
    z-index:900;
}

.overlay.active {
    display:block;
}

/* ---------- HAMBURGER ---------- */
#hamburger {
    position:fixed;
    top:16px;
    left:16px;
    z-index:1100;
    cursor:pointer;
    width:30px;
}

#hamburger div {
    height:4px;
    background:white;
    margin:5px 0;
    border-radius:2px;
}

/* ---------- HEADER ---------- */
header {
    background:#233465;
    color:white;
    padding:15px 20px;
    text-align:center;
    font-size:22px;
    font-weight:600;
    position:sticky;
    top:0;
    z-index:800;
}

/* ---------- CONTENT ---------- */
.content {
    padding:20px;
}

/* ---------- NOTICE CARDS ---------- */
.notice-container {
    max-width:900px;
    margin:30px auto;
}

.notice-card {
    background:white;
    border-left:5px solid #233465;
    border-radius:8px;
    padding:20px;
    margin-bottom:20px;
    box-shadow:0 3px 8px rgba(0,0,0,0.08);
}

.notice-card h3 {
    margin:0 0 10px;
    font-size:18px;
    color:#233465;
}

.notice-card p {
    font-size:15px;
}

.notice-card .date {
    font-size:14px;
    color:#555;
}

.notice-card button {
    background:#0077b6;
    color:white;
    border:none;
    padding:8px 14px;
    border-radius:5px;
    cursor:pointer;
}
</style>

</head>
<body>

<!-- Hamburger button -->
<div id="hamburger">
    <div></div>
    <div></div>
    <div></div>
</div>

<!-- Sidebar -->
<div class="sidebar" id="sidebar">
    <h2>TEACHER ERP</h2>
     <a href="teacher_dashboard.html">Dashboard</a>
        <a href="view_notices.html" style="background:rgba(255,255,255,0.25);">Notices and Circular</a>
    <a href="teacher_my_classes.html">My Timetable</a>
        <a href="teacher_attendance.html">Upload Attendance</a>    
    <a href="teacher_view_datesheet.html">View Datesheet</a>
    <a href="teacher_papers.html">Question Papers</a>
    <a href="teacher_marks_upload.html">Upload Marks</a>
    <a href="teacher_leave.html">Leave Permission</a>
</div>
<div class="overlay" id="overlay" onclick="closeMenu()"></div>

<!-- Page Content -->
<div class="content" id="content">
    <header>ðŸ“„ All Notices</header>

    <div class="notice-container" id="noticeList">
        <!-- Notices will be injected here -->
    </div>
</div>

<script>
const API = "https://exam-backend-ko0t.onrender.com";

/* Sidebar toggle */
const sidebar = document.getElementById("sidebar");
const overlay = document.getElementById("overlay");

document.getElementById("hamburger").onclick = () => {
    sidebar.classList.add("active");
    overlay.classList.add("active");
};

function closeMenu(){
    sidebar.classList.remove("active");
    overlay.classList.remove("active");
}
/* Load all notices */
async function loadNotices() {
    try {
const res = await fetch(`${API}/notice/list?role=teacher`);
        const data = await res.json();

        const container = document.getElementById("noticeList");
        container.innerHTML = "";

        if (!data.success || !data.notices.length) {
            container.innerHTML = "<p style='text-align:center; color:#555; margin-top:50px;'>No notices available.</p>";
            return;
        }

        data.notices.forEach(n => {
            const card = document.createElement("div");
            card.classList.add("notice-card");

            let pdfButton = "";
            if(n.file){ // only show if PDF exists
                pdfButton = `<button class="view-btn" onclick="viewNotice('${n.file}')">View PDF</button>`;
            }

            card.innerHTML = `
                <h3>ðŸ“Œ ${n.title}</h3>
                <p>${n.description || ""}</p>
                <p class="date">Date: ${n.date}</p>
                <div class="actions">
                    ${pdfButton}
                </div>
            `;
            container.appendChild(card);
        });

    } catch (err) {
        console.error(err);
        document.getElementById("noticeList").innerHTML = "<p style='text-align:center; color:red; margin-top:50px;'>Failed to load notices.</p>";
    }
}

loadNotices();

/* View PDF */
function viewNotice(filename){
    window.open(`${API}/notice/get-file/${filename}`, "_blank");
}
</script>

</body>
</html>
